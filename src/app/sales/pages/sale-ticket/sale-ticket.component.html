<!-- Contenedor principal: centrado y limpio -->
<div class="min-h-screen bg-white flex justify-center">
  <!-- Estado -->
  <div *ngIf="loading" class="w-[80mm] p-3 font-mono text-[11px] text-slate-700">
    Cargando venta...
  </div>

  <div *ngIf="error && !loading" class="w-[80mm] p-3 font-mono text-[11px] text-rose-600">
    {{ error }}
  </div>

  <!-- Ticket -->
  <div
    *ngIf="sale && !loading"
    id="ticket"
    class="w-[80mm] p-3 font-mono text-[11px] text-slate-900"
  >
    <!-- Header -->
    <div class="text-center">
      <div class="text-[13px] font-bold uppercase">MI NEGOCIO</div>
      <div class="text-[10px] text-slate-700 leading-4 mt-1">
        NIT: 1234567-8<br />
        Dirección: Ciudad de Guatemala<br />
        Tel: 0000-0000
      </div>
    </div>

    <div class="border-t border-dashed border-black my-2"></div>

    <!-- Info -->
    <div class="space-y-1">
      <div>Factura: {{ sale._id }}</div>
      <div>
        Fecha: {{ (sale.createdAt || sale.date) | date:'dd/MM/yyyy HH:mm' }}
      </div>

      <div *ngIf="sale.customer?.name">Cliente: {{ sale.customer?.name }}</div>
      <div *ngIf="sale.customer?.nit">NIT: {{ sale.customer?.nit }}</div>
    </div>

    <div class="border-t border-dashed border-black my-2"></div>

    <!-- Items -->
    <div class="grid grid-cols-[2fr_.7fr_1fr_1fr] gap-x-1 font-semibold border-b border-dashed border-black pb-1">
      <div>Detalle</div>
      <div class="text-right">Cant</div>
      <div class="text-right">Precio</div>
      <div class="text-right">Subt.</div>
    </div>

    <div class="mt-1 space-y-1">
      <div
        *ngFor="let item of sale.items"
        class="grid grid-cols-[2fr_.7fr_1fr_1fr] gap-x-1"
      >
        <div class="break-words pr-1">{{ item.name }}</div>
        <div class="text-right">{{ item.quantity }}</div>
        <div class="text-right">Q {{ item.price | number:'1.2-2' }}</div>
        <div class="text-right">Q {{ item.subtotal | number:'1.2-2' }}</div>
      </div>
    </div>

    <div class="border-t border-dashed border-black my-2"></div>

    <!-- Totales -->
    <div class="space-y-1">
      <div class="flex justify-between">
        <span>Subtotal</span>
        <span>Q {{ sale.subtotal || sale.total | number:'1.2-2' }}</span>
      </div>

      <div *ngIf="sale.discount && sale.discount > 0" class="flex justify-between">
        <span>Descuento</span>
        <span>- Q {{ sale.discount | number:'1.2-2' }}</span>
      </div>

      <div class="flex justify-between font-bold">
        <span>Total</span>
        <span>Q {{ sale.total | number:'1.2-2' }}</span>
      </div>

      <div *ngIf="sale.payment" class="pt-1 space-y-1">
        <div class="flex justify-between">
          <span>Pagó ({{ sale.payment.method }})</span>
          <span>Q {{ sale.payment.paid | number:'1.2-2' }}</span>
        </div>
        <div class="flex justify-between">
          <span>Cambio</span>
          <span>Q {{ sale.payment.change | number:'1.2-2' }}</span>
        </div>
      </div>
    </div>

    <div class="border-t border-dashed border-black my-2"></div>

    <div class="text-center text-[10px] text-slate-700">
      ¡Gracias por su compra!
    </div>
  </div>
</div>
